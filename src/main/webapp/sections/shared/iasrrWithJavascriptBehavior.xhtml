<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:pe="http://primefaces.org/ui/extensions">
<ui:composition>
        <h:panelGroup layout="block" styleClass="centerExample">
            <p:outputPanel id="example">
                <p:commandLink update="example"> 
                    <f:setPropertyActionListener target="#{imageController.imageUrl}" value="/resources/images/testImage1.png" />
                    <p:graphicImage value="/resources/images/testImage1.png" width="150" height="100"/>
                </p:commandLink>
                <p:commandLink update="example">  
                    <f:setPropertyActionListener target="#{imageController.imageUrl}" value="/resources/images/testImage2.png" />
                    <p:graphicImage value="/resources/images/testImage2.png" width="150" height="100"/>
                </p:commandLink>  	
                <p:commandLink update="example">
                    <f:setPropertyActionListener target="#{imageController.imageUrl}" value="/resources/images/testImage3.png" />
                    <p:graphicImage value="/resources/images/testImage3.png" width="150" height="100"/>
                </p:commandLink>
            
                <p:growl id="growl" showDetail="true" sticky="true" />
            
                <div id="imageWrapper" style="width:600px; height:400px; margin:auto; overflow:scroll; position:relative;">
                    <p:graphicImage id="myImage" value="#{imageController.imageUrl}" />				
                </div>
            
                <pe:imageAreaSelect id="areaSelect"
                    for="myImage"
                    widgetVar="areaSelectWidget"
                    autoHide="true"
                    handles="false"
                    movable="false"
                    persistent="false"
                    resizable="false"
                    parentSelector="#imageWrapper">
                    <p:ajax event="selectEnd" listener="#{imageController.selectEndListener}" update="growl"/>
                </pe:imageAreaSelect>
            
                <pe:imageRotateAndResize id="rotateAndResize" for="myImage" widgetVar="rotateAndResizeWidget">
                    <p:ajax event="rotate" listener="#{imageController.rotateListener}"
                            update="growl" oncomplete="areaSelectWidget.reload();"/>
                    <pe:javascript event="resize" execute="areaSelectWidget.reload();"/>
                </pe:imageRotateAndResize>
            
                <p:commandButton icon="ui-icon-arrowreturnthick-1-w" value="Rotate Left"
                    onclick="rotateAndResizeWidget.rotateLeft(90);return false;"/>
                <p:commandButton icon="ui-icon-arrowreturnthick-1-e" value="Rotate Right"
                    onclick="rotateAndResizeWidget.rotateRight(90);return false;"/>
                <p:commandButton icon="ui-icon-zoomin" value="Scale +"
                    onclick="rotateAndResizeWidget.scale(1.05);return false;"/>
                <p:commandButton icon="ui-icon-zoomout" value="Scale -"
                    onclick="rotateAndResizeWidget.scale(0.95);return false;"/>
            </p:outputPanel>
        </h:panelGroup>

        <ui:decorate template="/templates/twoTabsDecorator.html">
            <ui:define name="contentTab1">
&lt;p:outputPanel id=&quot;example&quot;&gt;
    &lt;p:commandLink update=&quot;example&quot;&gt; 
        &lt;f:setPropertyActionListener target=&quot;\#{imageController.imageUrl}&quot; value=&quot;/resources/images/testImage1.png&quot; /&gt;
        &lt;p:graphicImage value=&quot;/resources/images/testImage1.png&quot; width=&quot;150&quot; height=&quot;100&quot;/&gt;
    &lt;/p:commandLink&gt;
    &lt;p:commandLink update=&quot;example&quot;&gt;  
        &lt;f:setPropertyActionListener target=&quot;\#{imageController.imageUrl}&quot; value=&quot;/resources/images/testImage2.png&quot; /&gt;
        &lt;p:graphicImage value=&quot;/resources/images/testImage2.png&quot; width=&quot;150&quot; height=&quot;100&quot;/&gt;
    &lt;/p:commandLink&gt;  	
    &lt;p:commandLink update=&quot;example&quot;&gt;
        &lt;f:setPropertyActionListener target=&quot;\#{imageController.imageUrl}&quot; value=&quot;/resources/images/testImage3.png&quot; /&gt;
        &lt;p:graphicImage value=&quot;/resources/images/testImage3.png&quot; width=&quot;150&quot; height=&quot;100&quot;/&gt;
    &lt;/p:commandLink&gt;

    &lt;p:growl id=&quot;growl&quot; showDetail=&quot;true&quot; sticky=&quot;true&quot; /&gt;

    &lt;div id=&quot;imageWrapper&quot; style=&quot;width:600px; height:400px; margin:auto; overflow:scroll; position:relative;&quot;&gt;
        &lt;p:graphicImage id=&quot;myImage&quot; value=&quot;\#{imageController.imageUrl}&quot; /&gt;				
    &lt;/div&gt;

    &lt;pe:imageAreaSelect id=&quot;areaSelect&quot;
        for=&quot;myImage&quot;
        widgetVar=&quot;areaSelectWidget&quot;
        autoHide=&quot;true&quot;
        handles=&quot;false&quot;
        movable=&quot;false&quot;
        persistent=&quot;false&quot;
        resizable=&quot;false&quot;
        parentSelector=&quot;#imageWrapper&quot;&gt;
        &lt;p:ajax event=&quot;selectEnd&quot; listener=&quot;\#{imageController.selectEndListener}&quot; update=&quot;growl&quot;/&gt;
    &lt;/pe:imageAreaSelect&gt;

    &lt;pe:imageRotateAndResize id=&quot;rotateAndResize&quot; for=&quot;myImage&quot; widgetVar=&quot;rotateAndResizeWidget&quot;&gt;
        &lt;p:ajax event=&quot;rotate&quot; listener=&quot;\#{imageController.rotateListener}&quot;
                update=&quot;growl&quot; oncomplete=&quot;areaSelectWidget.reload();&quot;/&gt;
        &lt;pe:javascript event=&quot;resize&quot; execute=&quot;areaSelectWidget.reload();&quot;/&gt;
    &lt;/pe:imageRotateAndResize&gt;

    &lt;p:commandButton icon=&quot;ui-icon-arrowreturnthick-1-w&quot; value=&quot;Rotate Left&quot;
        onclick=&quot;rotateAndResizeWidget.rotateLeft(90);return false;&quot;/&gt;
    &lt;p:commandButton icon=&quot;ui-icon-arrowreturnthick-1-e&quot; value=&quot;Rotate Right&quot;
        onclick=&quot;rotateAndResizeWidget.rotateRight(90);return false;&quot;/&gt;
    &lt;p:commandButton icon=&quot;ui-icon-zoomin&quot; value=&quot;Scale +&quot;
        onclick=&quot;rotateAndResizeWidget.scale(1.05);return false;&quot;/&gt;
    &lt;p:commandButton icon=&quot;ui-icon-zoomout&quot; value=&quot;Scale -&quot;
        onclick=&quot;rotateAndResizeWidget.scale(0.95);return false;&quot;/&gt;
&lt;/p:outputPanel&gt;
            </ui:define>
            <ui:define name="contentTab2">
@ManagedBean
@ViewScoped
public class ImageController implements Serializable {

	private String imageUrl;

	public ImageController() {
		imageUrl = "../resources/images/testImage1.png";
	}

	public void selectEndListener(final ImageAreaSelectEvent e) {
		FacesMessage msg = new FacesMessage(FacesMessage.SEVERITY_INFO, "Area selected",
				"X1: " + e.getX1() 
				+ ", X2: " + e.getX2() 
				+ ", Y1: " + e.getY1()
				+ ", Y2: " + e.getY2()
		        + ", Image width: " + e.getImgWidth() 
		        + ", Image height: " + e.getImgHeight());

		FacesContext.getCurrentInstance().addMessage(null, msg);
	}

	public void rotateListener(final RotateEvent e) {
		FacesMessage msg = new FacesMessage(FacesMessage.SEVERITY_INFO, "Image rotated",
				"Degree:" + e.getDegree());

		FacesContext.getCurrentInstance().addMessage(null, msg);
	}

	public void resizeListener(final ResizeEvent e) {
		FacesMessage msg = new FacesMessage(FacesMessage.SEVERITY_INFO, "Image resized",
				"Width:" + e.getWidth() + ", Height: " + e.getHeight());

		FacesContext.getCurrentInstance().addMessage(null, msg);
	}

	public String getImageUrl() {
		return imageUrl;
	}

	public void setImageUrl(String imageUrl) {
		this.imageUrl = imageUrl;
	}
}
            </ui:define>
        </ui:decorate>
</ui:composition>
</html>
