<ui:composition
        xmlns:ui="http://java.sun.com/jsf/facelets"
        xmlns:h="http://java.sun.com/jsf/html"
        xmlns:f="http://java.sun.com/jsf/core"
        xmlns:p="http://primefaces.org/ui"
        xmlns:pe="http://primefaces.org/ui/extensions">
    <!-- EXAMPLE-SOURCE-START -->

    <p:messages id="messages" showSummary="true"/>

    <pe:dynaForm id="dynaForm" value="#{dynaFormController.model}" var="data" varStatus="curStatus">
        <pe:dynaFormCell type="label">
            <h:outputLabel value="${data.value}"/>
        </pe:dynaFormCell>
        <pe:dynaFormCell type="input">
            <p:inputText value="${data.value}" required="${data.required}" label="${data.name}"/>
        </pe:dynaFormCell>

        <f:facet name="buttonBar">
            <p:commandButton value="Submit" action="#{dynaFormController.submitForm}"
                             process="dynaForm" update="_mainForm_messages _mainForm_inputValues"
                             oncomplete="handleCompleteDynaForm(xhr, status, args)"/>
            <p:commandButton type="reset" value="Reset" style="margin-left: 5px;"/>
        </f:facet>
    </pe:dynaForm>

    <p:dialog header="Input values" widgetVar="inputValuesWidget">
        <p:dataList id="inputValues" value="#{dynaFormController.bookProperties}" var="bookProperty"
                    style="margin:10px;">
            <h:outputText value="#{bookProperty.name}: #{bookProperty.value}" style="margin-right: 10px;"/>
        </p:dataList>
    </p:dialog>

    <h:outputScript id="dynaFormScript" target="body">
        /* <![CDATA[ */
    function handleCompleteDynaForm(xhr, status, args) {
        if(args && args.isValid) {
            inputValuesWidget.show();
        } else {
            inputValuesWidget.hide();
        }
    }
    /* ]]> */
    </h:outputScript>

    <!-- EXAMPLE-SOURCE-END -->
</ui:composition>
